# Phone Agent - Androidè‡ªåŠ¨åŒ–æ™ºèƒ½åŠ©æ‰‹

<div align="center">

[![Android](https://img.shields.io/badge/Android-8.0+-green.svg)](https://developer.android.com)
[![Kotlin](https://img.shields.io/badge/Kotlin-1.9.10-blue.svg)](https://kotlinlang.org)
[![License](https://img.shields.io/badge/License-Apache%202.0-orange.svg)](LICENSE)

**åŸºäº [Open-AutoGLM](https://github.com/zai-org/Open-AutoGLM) æ¶æ„çš„ Android åŸç”Ÿæ™ºèƒ½ä½“åº”ç”¨**

é€šè¿‡è§†è§‰è¯­è¨€æ¨¡å‹ï¼ˆVLMï¼‰ç†è§£å±å¹•å†…å®¹ï¼Œè‡ªåŠ¨å®Œæˆå¤æ‚çš„æ‰‹æœºæ“ä½œä»»åŠ¡

[åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [å·¥ä½œåŸç†](#-å·¥ä½œåŸç†) â€¢ [ä½¿ç”¨ç¤ºä¾‹](#-ä½¿ç”¨ç¤ºä¾‹) â€¢ [å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)

</div>

---

## ğŸ“± ç®€ä»‹

Phone Agent æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ Android æ‰‹æœºä¸Šçš„æ™ºèƒ½è‡ªåŠ¨åŒ–åŠ©æ‰‹ï¼Œå®ƒèƒ½å¤Ÿï¼š

- ğŸ§  **ç†è§£è‡ªç„¶è¯­è¨€æŒ‡ä»¤**ï¼šç”¨äººè¯æè¿°ä»»åŠ¡ï¼Œæ— éœ€ç¼–å†™è„šæœ¬
- ğŸ‘€ **å®æ—¶åˆ†æå±å¹•å†…å®¹**ï¼šåŸºäºæˆªå›¾æ™ºèƒ½å†³ç­–ä¸‹ä¸€æ­¥æ“ä½œ
- ğŸ¤– **è‡ªä¸»å®Œæˆå¤æ‚ä»»åŠ¡**ï¼šä»æ‰“å¼€åº”ç”¨åˆ°å®Œæˆè´­ç‰©å…¨æµç¨‹è‡ªåŠ¨åŒ–
- ğŸ”„ **æŒç»­å­¦ä¹ ä¼˜åŒ–**ï¼šé€šè¿‡å¯¹è¯å†å²ç†è§£ä¸Šä¸‹æ–‡ï¼Œè¶Šç”¨è¶Šæ™ºèƒ½

### ä¸ PC ç‰ˆ Open-AutoGLM çš„å¯¹æ¯”

| ç‰¹æ€§ | PC ç‰ˆ (ADB) | Phone Agent (åŸç”Ÿ) |
|------|------------|-------------------|
| è¿è¡Œç¯å¢ƒ | PC + USBè¿æ¥ | æ‰‹æœºç‹¬ç«‹è¿è¡Œ |
| æˆªå±æ–¹å¼ | ADB screencap | MediaProjection |
| æ“ä½œæ‰§è¡Œ | ADB shell input | æ— éšœç¢æœåŠ¡ |
| éƒ¨ç½²éš¾åº¦ | éœ€è¦ PC ç¯å¢ƒ | æ‰‹æœºç›´æ¥å®‰è£… |
| ä¾¿æºæ€§ | â­â­â­ | â­â­â­â­â­ |
| å®æ—¶æ€§ | ç¨æœ‰å»¶è¿Ÿ | å³æ—¶å“åº” |

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒèƒ½åŠ›

- **æ™ºèƒ½ä»»åŠ¡è§„åˆ’**
  - è‡ªåŠ¨åˆ†è§£å¤æ‚ä»»åŠ¡ä¸ºå¤šä¸ªæ­¥éª¤
  - æ ¹æ®å±å¹•çŠ¶æ€åŠ¨æ€è°ƒæ•´æ‰§è¡Œç­–ç•¥
  - æ”¯æŒæ¡ä»¶åˆ¤æ–­å’Œé”™è¯¯æ¢å¤

- **å¤šæ¨¡æ€ç†è§£**
  - è§†è§‰ï¼šåˆ†æå±å¹•æˆªå›¾è¯†åˆ«UIå…ƒç´ 
  - æ–‡æœ¬ï¼šç†è§£è‡ªç„¶è¯­è¨€ä»»åŠ¡æè¿°
  - ä¸Šä¸‹æ–‡ï¼šç»´æŠ¤å®Œæ•´å¯¹è¯å†å²

- **ä¸°å¯Œçš„æ“ä½œæŒ‡ä»¤**
  ```
  âœ“ Launch   - å¯åŠ¨åº”ç”¨
  âœ“ Tap      - ç‚¹å‡»å…ƒç´ 
  âœ“ Type     - è¾“å…¥æ–‡æœ¬
  âœ“ Swipe    - æ»‘åŠ¨å±å¹•
  âœ“ Back     - è¿”å›ä¸Šä¸€çº§
  âœ“ Home     - å›åˆ°æ¡Œé¢
  âœ“ Wait     - ç­‰å¾…åŠ è½½
  âœ“ Long Press / Double Tap
  ```

- **æ™ºèƒ½å®‰å…¨é˜²æŠ¤**
  - æ•æ„Ÿæ“ä½œç¡®è®¤æœºåˆ¶
  - æ”¯ä»˜é¡µé¢è‡ªåŠ¨æš‚åœ
  - äººå·¥æ¥ç®¡è¯·æ±‚

### ğŸ”§ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Phone Agent                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI Layer (Jetpack Compose)                     â”‚
â”‚   â””â”€ MainActivity.kt                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent Core                                      â”‚
â”‚   â”œâ”€ AgentExecutor.kt    (ä¸»å¾ªç¯)               â”‚
â”‚   â”œâ”€ LLMApi.kt           (æ¨¡å‹é€šä¿¡)              â”‚
â”‚   â””â”€ TaskPlanner.kt      (åŠ¨ä½œè§£æ)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  System Services                                 â”‚
â”‚   â”œâ”€ MyAccessibilityService    (æ‰§è¡Œæ“ä½œ)        â”‚
â”‚   â”œâ”€ ScreenCaptureService      (æˆªå±)           â”‚
â”‚   â””â”€ AppInfoProvider           (åº”ç”¨è¿½è¸ª)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  External API                                    â”‚
â”‚   â””â”€ Vision-Language Model (AutoGLM-Phone-9B)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Android è®¾å¤‡**: Android 8.0 (API 26) åŠä»¥ä¸Š
- **å†…å­˜**: å»ºè®® 4GB ä»¥ä¸Š
- **LLM æœåŠ¡**: æ”¯æŒ OpenAI å…¼å®¹æ¥å£çš„è§†è§‰è¯­è¨€æ¨¡å‹
  - æ¨è: [AutoGLM-Phone-9B](https://github.com/THUDM/AutoGLM)
  - æˆ–å…¶ä»–æ”¯æŒå›¾åƒè¾“å…¥çš„æ¨¡å‹

### å®‰è£…æ­¥éª¤

#### 1ï¸âƒ£ å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-repo/phone-agent.git
cd phone-agent
```

#### 2ï¸âƒ£ ä½¿ç”¨ Android Studio æ‰“å¼€

```bash
# æ‰“å¼€ Android Studio
# File -> Open -> é€‰æ‹©é¡¹ç›®ç›®å½•
```

#### 3ï¸âƒ£ é…ç½® Gradle

ç¡®ä¿ `build.gradle.kts` ä¸­çš„ä¾èµ–æ­£ç¡®ï¼š

```kotlin
android {
    compileSdk = 34
    defaultConfig {
        minSdk = 26
        targetSdk = 34
    }
}

dependencies {
    implementation("androidx.compose.material3:material3")
    implementation("com.squareup.okhttp3:okhttp:4.12.0")
    implementation("com.google.code.gson:gson:2.10.1")
    // ... å…¶ä»–ä¾èµ–
}
```

#### 4ï¸âƒ£ ç¼–è¯‘å¹¶å®‰è£…

```bash
./gradlew assembleDebug
adb install app/build/outputs/apk/debug/app-debug.apk
```

æˆ–ç›´æ¥åœ¨ Android Studio ä¸­ç‚¹å‡» **Run** æŒ‰é’®

---

## âš™ï¸ é…ç½®æŒ‡å—

### 1. LLM æœåŠ¡éƒ¨ç½²

#### é€‰é¡¹ A: ä½¿ç”¨ AutoGLM-Phone-9B (æ¨è)

```bash
# å…‹éš†æ¨¡å‹ä»“åº“
git clone https://github.com/THUDM/AutoGLM.git
cd AutoGLM

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨ API æœåŠ¡
python -m phone_agent.api.server \
    --model-path /path/to/autoglm-phone-9b \
    --host 0.0.0.0 \
    --port 8000
```

#### é€‰é¡¹ B: ä½¿ç”¨å…¶ä»– VLM

ä»»ä½•æ”¯æŒä»¥ä¸‹æ ¼å¼çš„æ¨¡å‹éƒ½å¯ä»¥ï¼š

```python
# API è¯·æ±‚æ ¼å¼
POST /v1/chat/completions
{
  "model": "your-model",
  "messages": [
    {
      "role": "user",
      "content": [
        {"type": "image_url", "image_url": {"url": "data:image/png;base64,..."}},
        {"type": "text", "text": "ä»»åŠ¡æè¿°"}
      ]
    }
  ]
}

# API å“åº”æ ¼å¼
{
  "choices": [
    {
      "message": {
        "content": "<think>æ¨ç†è¿‡ç¨‹</think><answer>do(action=\"Tap\", element=[500,800])</answer>"
      }
    }
  ]
}
```

### 2. æ‰‹æœºç«¯é…ç½®

#### æ­¥éª¤ 1: å¯ç”¨å¼€å‘è€…é€‰é¡¹

```
è®¾ç½® â†’ å…³äºæ‰‹æœº â†’ è¿ç»­ç‚¹å‡»"ç‰ˆæœ¬å·" 7æ¬¡
```

#### æ­¥éª¤ 2: å¯ç”¨æ— éšœç¢æœåŠ¡

```
è®¾ç½® â†’ è¾…åŠ©åŠŸèƒ½ â†’ å·²ä¸‹è½½çš„æœåŠ¡ â†’ Phone Agent â†’ å¼€å¯
```

âš ï¸ **é‡è¦**: æ— éšœç¢æƒé™æ˜¯æ‰§è¡Œæ“ä½œçš„æ ¸å¿ƒï¼Œå¿…é¡»æˆäºˆ

#### æ­¥éª¤ 3: æˆäºˆæ‚¬æµ®çª—æƒé™ï¼ˆå¯é€‰ï¼‰

```
è®¾ç½® â†’ åº”ç”¨ç®¡ç† â†’ Phone Agent â†’ æƒé™ â†’ æ˜¾ç¤ºæ‚¬æµ®çª— â†’ å…è®¸
```

#### æ­¥éª¤ 4: é…ç½® API åœ°å€

æ‰“å¼€ Phone Agent åº”ç”¨ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API é…ç½®                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ API URL                         â”‚
â”‚ http://192.168.1.100:8000/v1/   â”‚  â† å¡«å…¥ä½ çš„æœåŠ¡å™¨åœ°å€
â”‚   chat/completions              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¸¸è§åœ°å€æ ¼å¼**ï¼š
- æœ¬åœ°æœåŠ¡å™¨: `http://192.168.1.100:8000/v1/chat/completions`
- Android æ¨¡æ‹Ÿå™¨: `http://10.0.2.2:8000/v1/chat/completions`
- äº‘æœåŠ¡: `https://your-domain.com/v1/chat/completions`

#### æ­¥éª¤ 5: æˆäºˆæˆªå±æƒé™

é¦–æ¬¡æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œä¼šå¼¹å‡ºæˆªå±æƒé™è¯·æ±‚ï¼š

```
å…è®¸ Phone Agent å¼€å§‹å½•åˆ¶/æŠ•å±?
[ç«‹å³å¼€å§‹] [å–æ¶ˆ]
```

ç‚¹å‡» **[ç«‹å³å¼€å§‹]** æˆäºˆæƒé™

---

## ğŸ® å·¥ä½œåŸç†

### Agent æ‰§è¡Œå¾ªç¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¼€å§‹ä»»åŠ¡                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ï¸âƒ£ æ„ŸçŸ¥ (Perceive)                                      â”‚
â”‚  â”œâ”€ æˆªå–å½“å‰å±å¹•                                          â”‚
â”‚  â”œâ”€ è·å–å½“å‰åº”ç”¨å                                        â”‚
â”‚  â””â”€ è½¬æ¢ä¸º Base64                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ï¸âƒ£ æ€è€ƒ (Think)                                         â”‚
â”‚  â”œâ”€ å‘é€æˆªå›¾ + ä»»åŠ¡ + å†å²åˆ° LLM                          â”‚
â”‚  â”œâ”€ LLM åˆ†æå±å¹•å†…å®¹                                      â”‚
â”‚  â”œâ”€ æ¨ç†ä¸‹ä¸€æ­¥æ“ä½œ                                        â”‚
â”‚  â””â”€ è¾“å‡º: <think>æ¨ç†</think><answer>åŠ¨ä½œ</answer>        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ï¸âƒ£ æ‰§è¡Œ (Act)                                           â”‚
â”‚  â”œâ”€ è§£æåŠ¨ä½œæŒ‡ä»¤                                          â”‚
â”‚  â”œâ”€ è½¬æ¢åæ ‡ (0-1000 â†’ å®é™…åƒç´ )                         â”‚
â”‚  â”œâ”€ é€šè¿‡æ— éšœç¢æœåŠ¡æ‰§è¡Œ                                    â”‚
â”‚  â””â”€ ç­‰å¾…ç•Œé¢æ›´æ–°                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
                 å®Œæˆ or ç»§ç»­?
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚
       å®Œæˆ                    ç»§ç»­
         â”‚                       â”‚
         â–¼                       â–¼
      ğŸ‰ ç»“æŸ              è¿”å›æ­¥éª¤ 1ï¸âƒ£
```

### å¯¹è¯å†å²ç®¡ç†

```kotlin
// ç¬¬ä¸€è½®
messages = [
  {"role": "system", "content": "ç³»ç»Ÿæç¤ºè¯..."},
  {"role": "user", "content": [
    {"type": "image_url", "image_url": {"url": "data:image/png;base64,..."}},
    {"type": "text", "text": "æ‰“å¼€æ·˜å®æœç´¢ç‰›å¥¶\n\n{\"current_app\": \"System Home\"}"}
  ]},
]

// LLM è¿”å›
response = "<think>å½“å‰åœ¨æ¡Œé¢ï¼Œéœ€è¦å…ˆæ‰“å¼€æ·˜å®</think><answer>do(action=\"Launch\", app=\"æ·˜å®\")</answer>"

// ç¬¬äºŒè½®ï¼ˆè¿½åŠ å†å²ï¼‰
messages += [
  {"role": "assistant", "content": "<think>...</think><answer>...</answer>"},
  {"role": "user", "content": [
    {"type": "image_url", "image_url": {"url": "..."}},  // æ–°æˆªå›¾
    {"type": "text", "text": "{\"current_app\": \"æ·˜å®\"}"}
  ]}
]

// æŒç»­å¾ªç¯...
```

### åæ ‡ç³»ç»Ÿ

LLM ä½¿ç”¨å½’ä¸€åŒ–åæ ‡ (0-1000)ï¼Œæ‰§è¡Œæ—¶è½¬æ¢ä¸ºå®é™…åƒç´ ï¼š

```kotlin
// LLM è¾“å‡º
do(action="Tap", element=[500, 800])

// è½¬æ¢è®¡ç®—ï¼ˆå‡è®¾å±å¹• 1080x2340ï¼‰
actual_x = 500 / 1000 * 1080 = 540 px
actual_y = 800 / 1000 * 2340 = 1872 px

// æ‰§è¡Œç‚¹å‡»
accessibilityController.click(540, 1872)
```

---

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: æ·˜å®è´­ç‰©

**æŒ‡ä»¤**:
```
æ‰“å¼€æ·˜å®æœç´¢ç‰›å¥¶ï¼ŒæŒ‰é”€é‡æ’åºï¼ŒåŠ è´­ç¬¬ä¸€ä¸ªå•†å“
```

**æ‰§è¡Œæ—¥å¿—**:
```
[14:32:10] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[14:32:10] ğŸ¯ ä»»åŠ¡ç›®æ ‡: æ‰“å¼€æ·˜å®æœç´¢ç‰›å¥¶ï¼ŒæŒ‰é”€é‡æ’åºï¼ŒåŠ è´­ç¬¬ä¸€ä¸ªå•†å“
[14:32:10] â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[14:32:10] â”â”â” ç¬¬ 1 æ­¥ â”â”â”
[14:32:10] ğŸ“± å½“å‰åº”ç”¨: System Home
[14:32:12] ğŸ’­ æ€è€ƒ: å½“å‰åœ¨æ¡Œé¢ï¼Œéœ€è¦å…ˆæ‰“å¼€æ·˜å®åº”ç”¨
[14:32:12] ğŸš€ å¯åŠ¨åº”ç”¨: com.taobao.taobao

[14:32:15] â”â”â” ç¬¬ 2 æ­¥ â”â”â”
[14:32:15] ğŸ“± å½“å‰åº”ç”¨: æ·˜å®
[14:32:17] ğŸ’­ æ€è€ƒ: æ·˜å®å·²æ‰“å¼€ï¼Œä½†æœ‰å¼¹çª—å¹¿å‘Šï¼Œå…ˆå…³é—­
[14:32:17] ğŸ‘† ç‚¹å‡» (540, 1755)

[14:32:19] â”â”â” ç¬¬ 3 æ­¥ â”â”â”
[14:32:20] ğŸ’­ æ€è€ƒ: å¼¹çª—å·²å…³é—­ï¼Œç‚¹å‡»é¡¶éƒ¨æœç´¢æ¡†
[14:32:20] ğŸ‘† ç‚¹å‡» (540, 200)

[14:32:22] â”â”â” ç¬¬ 4 æ­¥ â”â”â”
[14:32:23] ğŸ’­ æ€è€ƒ: æœç´¢æ¡†å·²æ¿€æ´»ï¼Œè¾“å…¥"ç‰›å¥¶"
[14:32:23] âŒ¨ï¸ è¾“å…¥: ç‰›å¥¶

[14:32:25] â”â”â” ç¬¬ 5 æ­¥ â”â”â”
[14:32:26] ğŸ’­ æ€è€ƒ: ç‚¹å‡»æœç´¢æŒ‰é’®
[14:32:26] ğŸ‘† ç‚¹å‡» (980, 200)

[14:32:28] â”â”â” ç¬¬ 6 æ­¥ â”â”â”
[14:32:29] ğŸ’­ æ€è€ƒ: æœç´¢ç»“æœå·²æ˜¾ç¤ºï¼Œç‚¹å‡»"ç»¼åˆæ’åº"åˆ‡æ¢ä¸ºé”€é‡
[14:32:29] ğŸ‘† ç‚¹å‡» (900, 350)

[14:32:31] â”â”â” ç¬¬ 7 æ­¥ â”â”â”
[14:32:32] ğŸ’­ æ€è€ƒ: ç‚¹å‡»"é”€é‡"é€‰é¡¹
[14:32:32] ğŸ‘† ç‚¹å‡» (700, 500)

[14:32:34] â”â”â” ç¬¬ 8 æ­¥ â”â”â”
[14:32:35] ğŸ’­ æ€è€ƒ: å·²æŒ‰é”€é‡æ’åºï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªå•†å“
[14:32:35] ğŸ‘† ç‚¹å‡» (540, 700)

[14:32:37] â”â”â” ç¬¬ 9 æ­¥ â”â”â”
[14:32:38] ğŸ’­ æ€è€ƒ: å•†å“è¯¦æƒ…é¡µå·²æ‰“å¼€ï¼Œç‚¹å‡»"åŠ è´­ç‰©è½¦"
[14:32:38] ğŸ‘† ç‚¹å‡» (800, 2100)

[14:32:40] â”â”â” ç¬¬ 10 æ­¥ â”â”â”
[14:32:41] ğŸ’­ æ€è€ƒ: å·²æˆåŠŸåŠ å…¥è´­ç‰©è½¦ï¼Œä»»åŠ¡å®Œæˆ
[14:32:41] ğŸ‰ å®Œæˆ

[14:32:41] âœ… ä»»åŠ¡å®Œæˆ: å·²æˆåŠŸå°†å•†å“åŠ å…¥è´­ç‰©è½¦
```

### ç¤ºä¾‹ 2: å¾®ä¿¡å‘æ¶ˆæ¯

**æŒ‡ä»¤**:
```
æ‰“å¼€å¾®ä¿¡ç»™"å¼ ä¸‰"å‘é€æ¶ˆæ¯"ä»Šå¤©ä¸‹ç­ä¸€èµ·åƒé¥­"
```

**å…³é”®æ­¥éª¤**:
1. Launch å¾®ä¿¡
2. Tap é¡¶éƒ¨æœç´¢æ¡†
3. Type "å¼ ä¸‰"
4. Tap æœç´¢ç»“æœç¬¬ä¸€ä¸ª
5. Tap åº•éƒ¨è¾“å…¥æ¡†
6. Type "ä»Šå¤©ä¸‹ç­ä¸€èµ·åƒé¥­"
7. Tap å‘é€æŒ‰é’®
8. Finish

### ç¤ºä¾‹ 3: æŠ–éŸ³æµè§ˆ

**æŒ‡ä»¤**:
```
æ‰“å¼€æŠ–éŸ³æœç´¢å‘¨æ°ä¼¦ï¼Œç‚¹èµå‰3ä¸ªè§†é¢‘
```

### ç¤ºä¾‹ 4: ç³»ç»Ÿè®¾ç½®

**æŒ‡ä»¤**:
```
æ‰“å¼€è®¾ç½®ï¼Œå…³é—­è“ç‰™ï¼Œè°ƒä½å±å¹•äº®åº¦
```

---

## ğŸ” æ”¯æŒçš„æ“ä½œ

### åº”ç”¨æ§åˆ¶

```kotlin
// å¯åŠ¨åº”ç”¨
do(action="Launch", app="æ·˜å®")
do(action="Launch", app="com.taobao.taobao")  // ä¹Ÿå¯ä»¥ç”¨åŒ…å

// ç³»ç»Ÿå¯¼èˆª
do(action="Back")      // è¿”å›
do(action="Home")      // æ¡Œé¢
```

### è§¦æ‘¸äº¤äº’

```kotlin
// ç‚¹å‡»
do(action="Tap", element=[500, 800])

// æ•æ„Ÿæ“ä½œç‚¹å‡»ï¼ˆéœ€è¦ç¡®è®¤ï¼‰
do(action="Tap", element=[500, 800], message="ç¡®è®¤æ”¯ä»˜")

// é•¿æŒ‰
do(action="Long Press", element=[500, 800])

// åŒå‡»
do(action="Double Tap", element=[500, 800])

// æ»‘åŠ¨
do(action="Swipe", start=[500, 1500], end=[500, 500])  // å‘ä¸Šæ»‘åŠ¨
```

### æ–‡æœ¬è¾“å…¥

```kotlin
// æ™®é€šè¾“å…¥
do(action="Type", text="è¦è¾“å…¥çš„æ–‡æœ¬")

// äººåè¾“å…¥ï¼ˆæŸäº›åº”ç”¨æœ‰ç‰¹æ®Šå¤„ç†ï¼‰
do(action="Type_Name", text="å¼ ä¸‰")
```

### æµç¨‹æ§åˆ¶

```kotlin
// ç­‰å¾…
do(action="Wait", duration="2 seconds")
do(action="Wait", duration="500 ms")

// ä»»åŠ¡å®Œæˆ
finish(message="ä»»åŠ¡å·²å®Œæˆ")

// è¯·æ±‚äººå·¥æ¥ç®¡
do(action="Take_over", message="éœ€è¦è¾“å…¥éªŒè¯ç ")
```

---

## ğŸ› ï¸ è¿›é˜¶é…ç½®

### è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯

ç¼–è¾‘ `config/SystemPrompt.kt`:

```kotlin
object SystemPrompt {
    fun getChinese(): String {
        return """
        // åœ¨è¿™é‡Œè‡ªå®šä¹‰ä½ çš„æç¤ºè¯
        // å¯ä»¥æ·»åŠ ç‰¹å®šåº”ç”¨çš„æ“ä½œè§„åˆ™
        // æˆ–é’ˆå¯¹ç‰¹å®šä»»åŠ¡çš„ä¼˜åŒ–ç­–ç•¥
        """.trimIndent()
    }
}
```

### æ·»åŠ æ–°çš„åº”ç”¨åŒ…åæ˜ å°„

ç¼–è¾‘ `utils/AppInfoProvider.kt`:

```kotlin
private fun getAppName(packageName: String): String? {
    return when (packageName) {
        "com.your.app" -> "ä½ çš„åº”ç”¨å",
        // æ·»åŠ æ›´å¤š...
        else -> null
    }
}
```

### è°ƒæ•´æ‰§è¡Œå‚æ•°

ç¼–è¾‘ `AgentExecutor.kt`:

```kotlin
companion object {
    const val MAX_STEPS = 100        // æœ€å¤§æ­¥æ•°
    const val STEP_DELAY_MS = 1500L  // æ­¥éª¤é—´å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰
}
```

### ä¿®æ”¹ LLM å‚æ•°

ç¼–è¾‘ `model/ModelConfig.kt`:

```kotlin
data class ModelConfig(
    val modelName: String = "autoglm-phone-9b",
    val maxTokens: Int = 3000,
    val temperature: Float = 0.0f,    // 0.0 = ç¡®å®šæ€§, 1.0 = åˆ›é€ æ€§
    val topP: Float = 0.85f,
    val frequencyPenalty: Float = 0.2f
)
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ— æ³•æˆªå± / æˆªå±æ˜¾ç¤ºé»‘å±

**åŸå› **: æˆªå±æƒé™æœªæ­£ç¡®æˆäºˆæˆ–æœåŠ¡æœªå¯åŠ¨

**è§£å†³æ–¹æ¡ˆ**:
```
1. ç¡®ä¿å·²æˆäºˆæˆªå±æƒé™ï¼ˆå¯åŠ¨ä»»åŠ¡æ—¶ä¼šè¯·æ±‚ï¼‰
2. æ£€æŸ¥é€šçŸ¥æ æ˜¯å¦æ˜¾ç¤º"Phone Agent - æˆªå±æœåŠ¡è¿è¡Œä¸­"
3. å°è¯•é‡å¯åº”ç”¨
4. å¦‚æœä½¿ç”¨æ¨¡æ‹Ÿå™¨ï¼Œç¡®ä¿å¼€å¯äº†"GPU æ¸²æŸ“"
```

### Q2: ç‚¹å‡»/è¾“å…¥æ“ä½œæ— æ•ˆ

**åŸå› **: æ— éšœç¢æœåŠ¡æœªæ­£ç¡®å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```
1. è¿›å…¥ è®¾ç½® â†’ è¾…åŠ©åŠŸèƒ½ â†’ Phone Agent
2. ç¡®ä¿å¼€å…³æ˜¯æ‰“å¼€çŠ¶æ€
3. æŸäº›æ‰‹æœºéœ€è¦é¢å¤–æˆäºˆ"åå°å¼¹å‡ºç•Œé¢"æƒé™
4. é‡å¯åº”ç”¨åé‡è¯•
```

### Q3: LLM è¿”å›çš„åæ ‡ä¸å‡†ç¡®

**åŸå› **: åæ ‡è½¬æ¢é—®é¢˜æˆ–æ¨¡å‹å¹»è§‰

**è§£å†³æ–¹æ¡ˆ**:
```kotlin
// æ–¹æ¡ˆ1: è°ƒæ•´åæ ‡åç§»
private fun convertToAbsolute(relative: Int, dimension: Int): Int {
    return ((relative + OFFSET) / 1000.0 * dimension).toInt()
}

// æ–¹æ¡ˆ2: åœ¨æç¤ºè¯ä¸­å¼ºè°ƒ
"""
é‡è¦ï¼šåæ ‡ç³»ç»Ÿä»å·¦ä¸Šè§’(0,0)åˆ°å³ä¸‹è§’(999,999)
è¯·ä»”ç»†è§‚å¯Ÿå…ƒç´ ä½ç½®ï¼Œç»™å‡ºç²¾ç¡®åæ ‡
"""
```

### Q4: API è¿æ¥å¤±è´¥

**å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ**:

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| `Connection refused` | æœåŠ¡å™¨æœªå¯åŠ¨ | ç¡®ä¿ LLM æœåŠ¡æ­£åœ¨è¿è¡Œ |
| `Timeout` | ç½‘ç»œä¸é€š | æ£€æŸ¥æ‰‹æœºå’ŒæœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œ |
| `404 Not Found` | URL é”™è¯¯ | ç¡®è®¤ API è·¯å¾„æ­£ç¡® |
| `401 Unauthorized` | API Key é”™è¯¯ | æ£€æŸ¥é…ç½®ä¸­çš„ API Key |

**è°ƒè¯•æŠ€å·§**:
```bash
# åœ¨æ‰‹æœºä¸Šæµ‹è¯•è¿æ¥
curl http://192.168.1.100:8000/v1/models

# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
tail -f /path/to/llm/service.log
```

### Q5: ä»»åŠ¡æ‰§è¡Œåˆ°ä¸€åŠå¡ä½

**å¯èƒ½åŸå› **:
1. é¡µé¢åŠ è½½æ…¢ â†’ å¢åŠ  `STEP_DELAY_MS`
2. å¼¹çª—é®æŒ¡ â†’ ä¼˜åŒ–æç¤ºè¯å¤„ç†å¼¹çª—
3. LLM è¿›å…¥å¾ªç¯ â†’ æ·»åŠ æœ€å¤§æ­¥æ•°é™åˆ¶

**è§£å†³æ–¹æ¡ˆ**:
```kotlin
// å¢åŠ è¶…æ—¶æ£€æµ‹
if (stepCount > MAX_STEPS) {
    logger("ä»»åŠ¡è¶…æ—¶ï¼Œè¯·æ£€æŸ¥")
    return
}

// æ·»åŠ é‡è¯•æœºåˆ¶
repeat(3) { attempt ->
    if (executeAction(action)) {
        break
    }
    delay(1000)
}
```

### Q6: åº”ç”¨åç§°è¯†åˆ«é”™è¯¯

**åŸå› **: åŒ…åæœªåœ¨æ˜ å°„è¡¨ä¸­

**è§£å†³æ–¹æ¡ˆ**:
```kotlin
// æŸ¥çœ‹å®é™…åŒ…å
adb shell dumpsys window | grep mCurrentFocus

// æ·»åŠ åˆ° AppInfoProvider.kt
"com.unknown.app" -> "åº”ç”¨ä¸­æ–‡å"
```

### Q7: å†…å­˜å ç”¨è¿‡é«˜

**åŸå› **: å¯¹è¯å†å²å¤ªé•¿ï¼Œå›¾ç‰‡æ•°æ®æœªæ¸…ç†

**è§£å†³æ–¹æ¡ˆ**:
```kotlin
// å®šæœŸæ¸…ç†å†å²
if (context.size > MAX_CONTEXT_SIZE) {
    context.removeAt(1)  // ä¿ç•™ system message
    context.removeAt(1)  // åˆ é™¤æœ€æ—©çš„å¯¹è¯
}

// æˆªå›¾å‹ç¼©
bitmap.compress(Bitmap.CompressFormat.JPEG, 60, outputStream)  // é™ä½è´¨é‡
```

### Q8: æŸäº›åº”ç”¨æ— æ³•æ“ä½œ

**åŸå› **: åº”ç”¨å±è”½äº†æ— éšœç¢æœåŠ¡æˆ–æˆªå±

**å¸¸è§å—é™åº”ç”¨**:
- é“¶è¡Œç±»åº”ç”¨ï¼ˆå®‰å…¨é™åˆ¶ï¼‰
- æŸäº›æ”¯ä»˜åº”ç”¨
- ç³»ç»Ÿå®‰å…¨è®¾ç½®

**æ›¿ä»£æ–¹æ¡ˆ**:
- ä½¿ç”¨åº”ç”¨è‡ªå¸¦çš„è‡ªåŠ¨åŒ– API
- æˆ–è¯·æ±‚ `Take_over` äººå·¥å®Œæˆ

---

## ğŸ” å®‰å…¨ä¸éšç§

### æ•°æ®å®‰å…¨

- âœ… **æˆªå›¾ä»…åœ¨æœ¬åœ°å¤„ç†**ï¼šä¸ä¼šä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡å™¨
- âœ… **API é€šä¿¡å¯åŠ å¯†**ï¼šæ”¯æŒ HTTPS è¿æ¥
- âœ… **æ— æ•°æ®æ”¶é›†**ï¼šåº”ç”¨ä¸ä¼šæ”¶é›†æˆ–å­˜å‚¨ç”¨æˆ·æ•°æ®
- âš ï¸ **æ•æ„Ÿæ“ä½œç¡®è®¤**ï¼šæ¶‰åŠæ”¯ä»˜ç­‰æ“ä½œä¼šæš‚åœç­‰å¾…ç¡®è®¤

### æƒé™è¯´æ˜

| æƒé™ | ç”¨é€” | å¿…éœ€æ€§ |
|------|------|--------|
| æ— éšœç¢æœåŠ¡ | æ‰§è¡Œç‚¹å‡»ã€è¾“å…¥ç­‰æ“ä½œ | âœ… å¿…éœ€ |
| æˆªå±æƒé™ | è·å–å½“å‰å±å¹•å†…å®¹ | âœ… å¿…éœ€ |
| ç½‘ç»œæƒé™ | ä¸ LLM API é€šä¿¡ | âœ… å¿…éœ€ |
| å½•éŸ³æƒé™ | è¯­éŸ³è¾“å…¥åŠŸèƒ½ | â­• å¯é€‰ |
| æ‚¬æµ®çª—æƒé™ | æ˜¾ç¤ºçŠ¶æ€æç¤º | â­• å¯é€‰ |

### æœ€ä½³å®è·µ

1. **ä»…åœ¨å—ä¿¡ä»»çš„ç½‘ç»œä½¿ç”¨**ï¼šé¿å…å…¬å…± WiFi
2. **å®šæœŸæ£€æŸ¥ä»»åŠ¡æ—¥å¿—**ï¼šç¡®ä¿æ“ä½œç¬¦åˆé¢„æœŸ
3. **æ•æ„Ÿä»»åŠ¡äººå·¥ç¡®è®¤**ï¼šæ¶‰åŠæ”¯ä»˜ã€éšç§çš„æ“ä½œå»ºè®®æ‰‹åŠ¨å®Œæˆ
4. **åŠæ—¶åœæ­¢å¼‚å¸¸ä»»åŠ¡**ï¼šç‚¹å‡»"åœæ­¢ä»»åŠ¡"æŒ‰é’®

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# 1. Fork é¡¹ç›®
git clone https://github.com/YOUR_USERNAME/phone-agent.git

# 2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature

# 3. æäº¤æ›´æ”¹
git commit -m "Add: ä½ çš„åŠŸèƒ½æè¿°"

# 4. æ¨é€åˆ°åˆ†æ”¯
git push origin feature/your-feature

# 5. åˆ›å»º Pull Request
```

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ Kotlin å®˜æ–¹ç¼–ç è§„èŒƒ
- å‡½æ•°å’Œå˜é‡å‘½åä½¿ç”¨é©¼å³°å‘½åæ³•
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£
- æäº¤å‰è¿è¡Œ `./gradlew ktlintCheck`

### æŠ¥å‘Šé—®é¢˜

æäº¤ Issue æ—¶è¯·åŒ…å«ï¼š
- Android ç‰ˆæœ¬
- è®¾å¤‡å‹å·
- è¯¦ç»†çš„å¤ç°æ­¥éª¤
- æ—¥å¿—æˆªå›¾æˆ–æ–‡æœ¬

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº [Apache License 2.0](LICENSE) å¼€æº

```
Copyright 2024 Phone Agent Contributors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
```

---

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Open-AutoGLM](https://github.com/zai-org/Open-AutoGLM) - PC ç‰ˆè‡ªåŠ¨åŒ–æ¡†æ¶
- [AutoGLM](https://github.com/THUDM/AutoGLM) - è§†è§‰è¯­è¨€æ¨¡å‹
- [OkHttp](https://github.com/square/okhttp) - HTTP å®¢æˆ·ç«¯
- [Gson](https://github.com/google/gson) - JSON è§£æ

ç‰¹åˆ«æ„Ÿè°¢ Open-AutoGLM å›¢é˜Ÿæä¾›çš„æ¶æ„è®¾è®¡å’Œå®ç°æ€è·¯ï¼

---

## ğŸ“ è”ç³»æ–¹å¼